osx_image: xcode8.3
language: objective-c
podfile: Example/Podfile
before_install:
  - pod repo update --silent
  - pod install --project-directory=Example
script:
  - set -o pipefail
  - xcodebuild clean build -workspace Example/Funky.xcworkspace -scheme iOS-Example -sdk iphonesimulator10.3 -configuration Release | xcpretty --color
  - xcodebuild test -workspace Example/Funky.xcworkspace -scheme iOS-Example -sdk iphonesimulator10.3 -destination 'platform=iOS Simulator,name=iPhone 7,OS=10.3' ONLY_ACTIVE_ARCH=NO GCC_INSTRUMENT_PROGRAM_FLOW_ARCS=YES GCC_GENERATE_TEST_COVERAGE_FILES=YES | xcpretty --color
  - pod lib lint --allow-warnings
  - danger || true
  - rake docs:all || true
  - sleep 3
after_success:
  - bash <(curl -s https://codecov.io/bash)
